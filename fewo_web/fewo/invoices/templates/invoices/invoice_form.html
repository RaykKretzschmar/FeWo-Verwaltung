{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="card">
    <div class="card-body">
        <h2 class="card-title">{% if customer %}Create invoice for {{ customer }}{% else %}New Invoice{% endif %}</h2>

        <form method="post">{% csrf_token %}
            {{ form.non_field_errors }}
            <div class="mb-3">
                {{ form.customer.label_tag }} {{ form.customer }}
            </div>

            <div class="row">
                <div class="col-md-4 mb-3">{{ form.arrival_date.label_tag }} {{ form.arrival_date }}</div>
                <div class="col-md-4 mb-3">{{ form.departure_date.label_tag }} {{ form.departure_date }}</div>
                <div class="col-md-4 mb-3">{{ form.invoice_number.label_tag }} {{ form.invoice_number }}</div>
            </div>

            <div class="mb-3">{{ form.apartment_name.label_tag }} {{ form.apartment_name }}</div>

            <div class="row">
                <div class="col-md-4 mb-3">{{ form.price_per_night.label_tag }} {{ form.price_per_night }}</div>
                <div class="col-md-4 mb-3">
                    {{ form.include_breakfast }} {{ form.include_breakfast.label_tag }}
                </div>
                <div class="col-md-4 mb-3" id="breakfast-price-row">
                    {{ form.breakfast_price.label_tag }} {{ form.breakfast_price }}
                </div>
            </div>

            <div class="mb-3">{{ form.tax_percent.label_tag }} {{ form.tax_percent }}</div>

            <button class="btn btn-primary" type="submit">Create Invoice</button>
        </form>
    </div>
</div>

<script>
    function toggleBreakfastRow() {
        const cb = document.querySelector('input[name="include_breakfast"]');
        const row = document.getElementById('breakfast-price-row');
        if (!cb) return;
        row.style.display = cb.checked ? 'block' : 'none';
    }
    document.addEventListener('DOMContentLoaded', () => {
        toggleBreakfastRow();
        const cb = document.querySelector('input[name="include_breakfast"]');
        if (cb) cb.addEventListener('change', toggleBreakfastRow);
    });
</script>
{% endblock %}