<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 9pt;
            color: #333;
            line-height: 1.3;
        }

        .header {
            margin-bottom: 20px;
        }

        .company-info {
            font-size: 8pt;
            color: #666;
            line-height: 1.2;
        }

        .recipient-address {
            margin-top: 25px;
            margin-bottom: 20px;
        }

        .recipient-address .sender-line {
            font-size: 7pt;
            color: #999;
            border-bottom: 1px solid #ccc;
            padding-bottom: 2px;
            margin-bottom: 6px;
        }

        .invoice-title {
            font-size: 16pt;
            font-weight: bold;
            margin: 20px 0 15px 0;
        }

        .invoice-meta {
            margin-bottom: 20px;
        }

        .invoice-meta table {
            width: 100%;
            border-collapse: collapse;
        }

        .invoice-meta td {
            padding: 3px 0;
        }

        .invoice-meta td:first-child {
            width: 40%;
            font-weight: bold;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .items-table th {
            background-color: #f0f0f0;
            padding: 6px;
            text-align: left;
            border-bottom: 2px solid #333;
        }

        .items-table td {
            padding: 6px;
            border-bottom: 1px solid #ddd;
        }

        .items-table .amount {
            text-align: right;
        }

        .totals {
            width: 60%;
            margin-left: auto;
            margin-top: 15px;
        }

        .totals table {
            width: 100%;
            border-collapse: collapse;
        }

        .totals td {
            padding: 5px 6px;
        }

        .totals td:first-child {
            text-align: right;
        }

        .totals td:last-child {
            text-align: right;
            width: 30%;
        }

        .totals .total-row {
            font-weight: bold;
            font-size: 11pt;
            border-top: 2px solid #333;
            border-bottom: 3px double #333;
        }

        .footer {
            margin-top: 30px;
            font-size: 8pt;
            color: #666;
            line-height: 1.4;
        }

        .footer .bank-details {
            margin-top: 12px;
        }

        p {
            margin: 8px 0;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="company-info">
            {{ landlord_info|safe }}
        </div>
    </div>

    <div class="recipient-address">
        <div class="sender-line">
            {{ sender_line }}
        </div>
        <div>
            {% if customer.customer_type == 'Firma' %}
            {{ customer.company_name }}<br>
            {% else %}
            {{ customer.first_name }} {{ customer.last_name }}<br>
            {% endif %}
            {{ customer.street }} {{ customer.house_number }}<br>
            {{ customer.postal_code }} {{ customer.city }}
        </div>
    </div>

    <div class="invoice-meta">
        <table>
            <tr>
                <td>Rechnungsnummer:</td>
                <td>{{ invoice.invoice_number }}</td>
            </tr>
            <tr>
                <td>Datum:</td>
                <td>{{ invoice.date|date:"d.m.Y" }}</td>
            </tr>
            <tr>
                <td>Kundennummer:</td>
                <td>{{ customer.customer_number }}</td>
            </tr>
        </table>
    </div>

    <div class="invoice-title">Rechnung</div>

    <p>{{ greeting }},</p>
    <p>
        für Ihren Aufenthalt vom {{ invoice.arrival_date|date:"d.m.Y" }}
        bis {{ invoice.departure_date|date:"d.m.Y" }}
        {% if invoice.rental_property %}in {{ invoice.rental_property.name }}{% endif %}
        stellen wir Ihnen folgendes in Rechnung:
    </p>

    <table class="items-table">
        <thead>
            <tr>
                <th>Beschreibung</th>
                <th style="width: 15%; text-align: center;">Anzahl</th>
                <th style="width: 20%; text-align: right;">Einzelpreis</th>
                <th style="width: 20%; text-align: right;">Gesamtpreis</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Übernachtung{% if invoice.rental_property %} - {{ invoice.rental_property.name }}{% endif %}</td>
                <td style="text-align: center;">{{ invoice.nights }}</td>
                <td class="amount">{{ invoice.price_per_night|floatformat:2 }} €</td>
                <td class="amount">{{ invoice.lodging_total|floatformat:2 }} €</td>
            </tr>
            {% if invoice.include_breakfast %}
            <tr>
                <td>Frühstück</td>
                <td style="text-align: center;">{{ invoice.nights }}</td>
                <td class="amount">{{ invoice.breakfast_price|floatformat:2 }} €</td>
                <td class="amount">{{ invoice.breakfast_total|floatformat:2 }} €</td>
            </tr>
            {% endif %}
        </tbody>
    </table>

    <div class="totals">
        <table>
            <tr>
                <td>Nettobetrag:</td>
                <td>{{ invoice.net_amount|floatformat:2 }} €</td>
            </tr>
            <tr>
                <td>MwSt. {{ invoice.tax_percent }}%:</td>
                <td>{{ invoice.tax_amount|floatformat:2 }} €</td>
            </tr>
            <tr class="total-row">
                <td>Gesamtbetrag:</td>
                <td>{{ invoice.total_price|floatformat:2 }} €</td>
            </tr>
        </table>
    </div>

    <p style="margin-top: 20px;">
        Wir bitten um Überweisung des Rechnungsbetrags binnen 14 Tagen.
    </p>

    <p>Vielen Dank für Ihren Aufenthalt!</p>

    <div class="footer">
        <p style="margin: 0;">Mit freundlichen Grüßen<br>{{ company_name }}</p>

        {% if bank_details %}
        <div class="bank-details">
            <strong>Bankverbindung:</strong><br>
            {{ bank_details|linebreaksbr }}
        </div>
        {% endif %}

        {% if tax_number %}
        <div style="margin-top: 8px;">
            <strong>Steuernummer:</strong> {{ tax_number }}
        </div>
        {% endif %}
    </div>
</body>

</html>